<!doctype html>
<html>
<head>
	<title>Tic Tac Toe</title>

	<link href='http://fonts.googleapis.com/css?family=Raleway:900,300,600' rel='stylesheet' type='text/css'>
	<link rel="stylesheet" href="style/style.css">
</head>
<body>
	<div id="container">
        <div class="title">
            <h1>Tic-Tac-Toe</h1>
            <h3>Reinforcement Learning</h3>
            <h5>Taylor Baldwin</h5>
        </div>

        <div class="training-choices">
            <div class="local">Train Locally</div>
            <div class="distributed">Train with Distributed Learning</div>
        </div>
		<div id="game">
            <div class="squares"></div>
            <div class="scores">
                <h3>Scores</h3>
                <div class="total">Total Games: <span>0</span></div>
            </div>
            <div class="persisting-msg">Persisting With Server</div>
            <div class="buttons">
                <div class="toggle">Start/Stop Training</div>
            </div>
            <div class="choices"></div>
        </div>
	</div>
	<script src="bower_components/jquery/dist/jquery.min.js"></script>
	<script src="bower_components/lodash/dist/lodash.min.js"></script>
	<script src="bower_components/backbone/backbone.js"></script>

    <script src="js/Q.js"></script>
    <script src="js/Player.js"></script>
	<script src="js/Square.js"></script>
	<script src="js/TicTacToe.js"></script>
	<script>
		$(function() {

            $(document).on('click', '.local', startTraining.bind(null, 'local'))
                       .on('click', '.distributed', startTraining.bind(null, 'distributed'));

            function startTraining(method) {
                $(document).off('click');
                $('.training-choices').hide();
                $('#game').show();
                var persist = method === 'distributed';
                if (persist) {
                    $.getJSON('q').then(function(res) {
                        window.matrix = res.q['q_3_3'] || {}; // this will break if grid/streak changes
                    }).then(startGame.bind(null, persist));
                } else {
                    startGame(persist);
                }
            }

            function startGame(persist) {
                $('.persisting-msg').toggleClass('show', persist);
                window.game = new TicTacToe({
                    'grid': 3,
                    'streak': 3,
                    'players': [
                        new Player({
                            'persist': persist,
                            'isSmart': true,
                            'id': 'Smart'
                        }),
                        new Player({
                            'id': 'Kinda Smart',
                            'persist': persist,
                            'isComputer': true,
                            'isSmart': true,
                            'discover': 0.5
                        })
                    ]
                });
            }
		});
	</script>
</body>
</html>
